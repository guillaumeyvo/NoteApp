<!DOCTYPE html>
<html lang="en">
   <head>
      <title>NoteApp</title>
      <!-- BEGIN META -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="keywords" content="your,keywords">
      <meta name="description" content="Short explanation about this website">
      <!-- END META -->
      <!-- BEGIN STYLESHEETS -->
      <link href='http://fonts.googleapis.com/css?family=Roboto:300italic,400italic,300,400,500,700,900' rel='stylesheet' type='text/css'/>
      <link type="text/css" rel="stylesheet" href="/assets/css/theme-default/bootstrap.css?1422792965" />
      <link type="text/css" rel="stylesheet" href="/assets/css/theme-default/materialadmin.css?1425466319" />
      <link type="text/css" rel="stylesheet" href="/assets/css/theme-default/font-awesome.min.css?1422529194" />
      <link type="text/css" rel="stylesheet" href="/assets/css/theme-default/material-design-iconic-font.min.css?1421434286" />
      <link type="text/css" rel="stylesheet" href="/assets/css/theme-default/libs/summernote/summernote.css?1425218701" />
      <link type="text/css" rel="stylesheet" href="/assets/css/theme-default/libs/dropzone/dropzone-theme.css?1424887864" />
      <link rel="shortcut icon" href="assets/ico/favicon.png">
      <style type="text/css">
         .fileUpload {
         position: relative;
         overflow: hidden;
         margin: 10px;
         }
         .fileUpload input.upload {
         position: absolute;
         top: 0;
         right: 0;
         margin: 0;
         padding: 0;
         font-size: 20px;
         cursor: pointer;
         opacity: 0;
         filter: alpha(opacity=0);
         }
         .card-head.nav-tabs, .card-head > .nav-tabs {
         padding: 0px !important;
         }

         .noselect {
            -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none;   /* Chrome/Safari/Opera */
            -khtml-user-select: none;    /* Konqueror */
            -moz-user-select: none;      /* Firefox */
            -ms-user-select: none;       /* Internet Explorer/Edge */
            user-select: none;           /* Non-prefixed version, currently
                                            not supported by any browser */
          }

          .chat-avatar{
            width: 40px;
            height: 40px;
            border-radius: 40px;
          }



         @media screen and (min-width: 768px) {

	#manageRightModal .modal-dialog  {width:1000px;}

}
#manageRightModal .modal-dialog  {width:75%;}
      </style>
      <!-- END STYLESHEETS -->
      <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!--[if lt IE 9]>
      <script type="text/javascript" src="../../assets/js/libs/utils/html5shiv.js?1403934957"></script>
      <script type="text/javascript" src="../../assets/js/libs/utils/respond.min.js?1403934956"></script>
      <![endif]-->
   </head>
   <body class="menubar-hoverable header-fixed menubar-first full-content ">
      <!-- BEGIN HEADER-->
      <header id="header" >
         <div class="headerbar">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="headerbar-left">
               <ul class="header-nav header-nav-options">
                  <li class="header-nav-brand" >
                     <div class="brand-holder">
                        <a>
                        <span class="text-lg text-bold text-primary">NOTEAPP</span>
                        </a>
                     </div>
                  </li>
                  <li>
                     <a class="btn btn-icon-toggle menubar-toggle" data-toggle="menubar" href="javascript:void(0);">
                     <i class="fa fa-bars"></i>
                     </a>
                  </li>
               </ul>
            </div>
            <div class="headerbar-right">
               <ul class="header-nav header-nav-profile">
                  <li class="dropdown">
                     <a href="javascript:void(0);" class="dropdown-toggle ink-reaction" data-toggle="dropdown">
                     <img id="avatar" src="<%= avatar %>" alt="" />
                     <span class="profile-info" account="<%= account_type %>">
                     <%= email %>
                     </span>
                     </a>
                     <ul class="dropdown-menu animation-dock">
                        <% if(account_type == 'local'){ %>
                        <li><a href="#"  id="uploadlink"><i class="fa fa-fw fa-user"></i> Changer sa photo de profil</a></li>
                        <% } %>
                        <li><a href="#" id="userFolder"><i class="fa fa-fw fa-folder"></i> Gerer les dossiers</a></li>
                        <li class="divider"></li>
                        <li><a href="/logout"><i class="fa fa-fw fa-power-off text-danger"></i> Logout </a></li>
                     </ul>
                     <!--end .dropdown-menu -->
                  </li>
                  <!--end .dropdown -->
               </ul>
               <!--end .header-nav-profile -->
               <ul class="header-nav header-nav-toggle">
                  <li>
                     <a class="btn btn-icon-toggle btn-default" href="#offcanvas-search" data-toggle="offcanvas" data-backdrop="false">
                     <i class="fa fa-search"></i>
                     </a>
                  </li>
                  <li>
                     <a class="btn btn-icon-toggle btn-default" href="#offcanvas-chat-list" data-toggle="offcanvas" data-backdrop="false">
                     <i class="fa fa-users"></i>
                     </a>
                  </li>
                  <li>
                     <a class="btn btn-icon-toggle btn-default" id="chatMessageIcon" href="#offcanvas-chat" onclick="loadMessageChat()" data-toggle="offcanvas" data-backdrop="false">
                     <i class="md md-chat"></i>
                     </a>
                  </li>
               </ul>
               <!--end .header-nav-toggle -->
            </div>
            <!--end #header-navbar-collapse -->
         </div>
      </header>
      <!-- END HEADER-->
      <!-- BEGIN BASE-->
      <div id="base">
         <!-- BEGIN OFFCANVAS LEFT -->
         <div class="offcanvas">
         </div>
         <!--end .offcanvas-->
         <!-- END OFFCANVAS LEFT -->
         <!-- BEGIN CONTENT-->
         <div id="content">
            <section class="style-default-bright">
               <!-- BEGIN INBOX -->
               <div class="section-body">
                  <div class="row">
                     <div class="col-lg-12">
                        <div class="input-group-content">
                           <input type="text" class="form-control" id="noteTitle" placeholder="Entrer le type de la note">
                        </div>
                        <div class="input-group-content" id="sharedIcon">
                           <i class="fa fa-users" title="Note partagÃ©e"></i>
                        </div>

                        <div class="btn-group stick-top-right">
                           <!-- <select class="btn ink-reaction btn-flat btn-primary " id="sel1" >
                              <option>Option 1</option>
                              <option>2</option>
                              <option>3</option>
                              <option>4</option>
                              </select> -->
                           <button type="button" id="currentFolder" selectedFolderId="<%= userNote[0].id %>" class="btn ink-reaction btn-flat dropdown-toggle" data-toggle="dropdown">
                           <%= userNote[0].name %> <i class="fa fa-caret-down text-default-light" style='margin-left: 7px;'></i>
                           </button>
                           <ul class="dropdown-menu animation-zoom" id="folderList" role="menu">
                              <% for(var i=0; i<userNote.length; i++) { %>
                              <li><a href="#" folderid="<%= userNote[i].id %>" onclick="changeNoteFolder(this)"><%= userNote[i].name %></a></li>
                              <% } %>
                           </ul>
                           <a class="btn btn-icon-toggle btn-default" onclick="getFolderManageModal()" data-toggle="modal" data-target="#simpleModal"><i class="fa fa-folder" ></i></a>
                           <a class="btn btn-icon-toggle btn-default" onclick="addNewNote()"><i class="md md-add"></i></a>
                           <a id="toastTest" class="btn btn-icon-toggle btn-default" onclick="deleteNote()"><i class="md md-delete"></i></a>
                           <a onclick="updateNote()"  class="btn btn-icon-toggle btn-default"><i class="md md-save"></i></a>
                           <a onclick="shareNote()" id="shareNoteBtn"  class="btn btn-icon-toggle btn-default"><i class="md md-share"></i></a>
                        </div>
                        <span class="pull-right text-default-light" id="saveMessage"></span>
                        <hr/>
                        <form class="form" id="formCompose">
                           <div class="form-group">
                              <!-- <div id="simple-summernote" name="message" class="form-control control-12-rows" spellcheck="false"></div> -->
                              <div id="dSummernote"></div>
                           </div>
                           <!--end .form-group -->
                        </form>
                     </div>
                     <!--end .col -->
                     <!-- END MAIL COMPOSE -->
                  </div>
                  <!--end .row -->
               </div>
               <!--end .section-body -->
               <!-- END INBOX -->
            </section>
         </div>
         <!--end #content-->
         <!-- END CONTENT -->
         <!-- BEGIN MENUBAR-->
         <div id="menubar" class="menubar-inverse ">
            <div class="menubar-fixed-panel">
               <div>
                  <a class="btn btn-icon-toggle btn-default menubar-toggle" data-toggle="menubar" href="javascript:void(0);">
                  <i class="fa fa-bars"></i>
                  </a>
               </div>
               <div class="expanded">
                  <a>
                  <span class="text-lg text-bold text-primary ">NOTEAPP</span>
                  </a>
               </div>
            </div>
            <div class="menubar-scroll-panel">
               <!-- BEGIN MAIN MENU -->
               <ul id="main-menu" class="gui-controls">
                  <% for(var i=0; i<userNote.length; i++) { %>
                  <li class="gui-folder">
                     <a>
                        <div class="gui-icon"><i class="md md-folder"></i></div>
                        <span class="title" fid="<%= userNote[i].id %>"><%= userNote[i].name %></span>
                     </a>
                     <ul>
                        <% for(var j=0; j<userNote[i]["notes"].length; j++) { %>
                        <% if(i==0 && j==0){ %>
                        <li><a href="#" id="<%= userNote[i]["notes"][j].id %>" isShared="<%= userNote[i]["notes"][j].isShared %>" class="active" onclick="loadNoteOnEditor(this)"><span class="title"><%= userNote[i]["notes"][j].title %><i style="float: right;" class="md md-delete" onclick="deleteNote(this)"></i></span></a></li>
                        <% } else{ %>
                        <li><a href="#" id="<%= userNote[i]["notes"][j].id %>" isShared="<%= userNote[i]["notes"][j].isShared %>" onclick="loadNoteOnEditor(this)"><span class="title"><%= userNote[i]["notes"][j].title %><i style="float: right;" class="md md-delete" onclick="deleteNote(this,'menu')"></i></span></a></li>
                        <% } %>
                        <% } %>
                     </ul>
                  </li>
                  <% } %>
                  <% if(sharenote.length >0){ %>
                  <li class="gui-folder" id="sharedFolder">
                     <a>
                        <div class="gui-icon"><i class="md md-folder-shared"></i></div>
                        <span class="title">Notes Partagees</span>
                     </a>
                     <!--start submenu -->
                     <ul>
                        <% for(var i=0; i<sharenote.length; i++) { %>
                        <li class="gui-folder">
                           <a href="javascript:void(0);">
                           <span class="title"><%= sharenote[i].email %></span>
                           </a>
                           <!--start submenu -->
                           <ul>
                              <% for(var j=0; j<sharenote[i]["folders"].length; j++) { %>
                              <% for(var k=0; k<sharenote[i]["folders"][j]["notes"].length; k++) { %>
                              <li><a href="#" id="<%= sharenote[i]["folders"][j]["notes"][k].id %>" isShared="true" right="<%= sharenote[i]["folders"][j]["notes"][k]["shared_notes"][0].right %>" onclick="loadNoteOnEditor(this)"><span class="title"><%= sharenote[i]["folders"][j]["notes"][k].title %><i style="float: right;" class="md md-delete"></i></span></a></li>
                              <% } %>
                              <% } %>
                           </ul>
                           <!--end /submenu -->
                        </li>
                        <!--end /menu-li -->
                        <% } %>
                     </ul>
                     <!--end /submenu -->
                  </li>
                  <!--end /menu-li -->
                  <% } %>
               </ul>
               <!--end .main-menu -->
               <!-- END MAIN MENU -->
            </div>
            <!--end .menubar-scroll-panel-->
         </div>
         <!--end #menubar-->
         <!-- END MENUBAR -->
         <!-- BEGIN OFFCANVAS RIGHT -->
         <div class="offcanvas">
            <!-- BEGIN OFFCANVAS SEARCH -->
            <div id="offcanvas-search" class="offcanvas-pane width-8">
               <div class="offcanvas-head">
                  <header class="text-primary">Rechercher dans vos notes</header>
                  <div class="offcanvas-tools">
                     <a class="btn btn-icon-toggle btn-default-light pull-right" data-dismiss="offcanvas">
                     <i class="md md-close"></i>
                     </a>
                  </div>
               </div>
               <div class="offcanvas-body no-padding">
                  <ul class="list" id="searchResult">
                     <li class="tile divider-full-bleed">
                        <div class="tile-content">
                           <div class="tile-text">
                              <div class="input-group-content">
                                 <form class="form">
                                    <div class="form-group">
                                       <div class="input-group input-group-md">
                                          <div class="input-group-content">
                                             <input type="text" class="form-control" id="searchInput" placeholder="Recherche">
                                             <div class="form-control-line"></div>
                                          </div>
                                          <div class="input-group-btn">
                                             <!-- <button class="btn btn-floating-action btn-default-bright" type="button"><i class="fa fa-search"></i></button> -->
                                             <!-- <button onclick="search()" class="btn btn-icon-toggle ink-reaction"><i class="fa fa-search"></i></button> -->
                                             <a id="searchbtn" class="btn btn-icon-toggle btn-default" ><i class="fa fa-search"></i></a>
                                          </div>
                                       </div>
                                    </div>
                                    <!--end .form-group -->
                                 </form>
                              </div>
                           </div>
                        </div>
                     </li>
                  </ul>
               </div>
               <!--end .offcanvas-body -->
            </div>
            <!--end .offcanvas-pane -->
            <!-- END OFFCANVAS SEARCH -->
            <div id="offcanvas-chat" class="offcanvas-pane style-default-light width-12">
               <div class="offcanvas-head style-default-bright">
                  <header class="text-primary">Chat collaboratif</header>
                  <div class="offcanvas-tools">
                     <a class="btn btn-icon-toggle btn-default-light pull-right" data-dismiss="offcanvas">
                     <i class="md md-close"></i>
                     </a>
                     <a class="btn btn-icon-toggle btn-default-light pull-right" href="#offcanvas-chat-list" data-toggle="offcanvas" data-backdrop="false">
                     <i class="md md-arrow-back"></i>
                     </a>
                  </div>
                  <form class="form">
                     <div class="form-group floating-label">
                        <textarea name="chatMessage" id="chatMessage" class="form-control autosize" rows="1"></textarea>
                        <label for="chatMessage">Ecrivez quelque chose</label>
                     </div>
                  </form>
               </div>
               <div class="offcanvas-body">
                  <ul class="list-chats">
                    <!--  <li>
                        <div class="chat">
                           <div class="chat-avatar"><img class="img-circle" src="../../assets/img/avatar1.jpg?1403934956" alt="" /></div>
                           <div class="chat-body" id="tt">
                              Yes, it is indeed very beautiful.
                              <small>10:03 pm</small>
                           </div>
                        </div>
                     </li> -->
                  <!--    <li class="chat-left">
                        <div class="chat">
                           <div class="chat-avatar"><img class="img-circle" src="../../assets/img/avatar9.jpg?1404026744" alt="" /></div>
                           <div class="chat-body">
                              Did you see the changes?
                              <small>10:02 pm</small>
                           </div>
                        </div>
                     </li> -->

                     <li >
                        <div style="text-align:center;">
                           <button style="width:100%;font-size:10px;" type="button" class="btn btn-primary" id="btSave" >Charger plus de messages</button>
                        </div>
                     </li>
                     <li >
                        <div style="text-align:center;">
                           Aucun message<br>Cette note n'a pas encore ete partagee.
                        </div>
                     </li>
                  </ul>
               </div>
               <!--end .offcanvas-body -->

            </div>
            <!--end .offcanvas-pane -->
            <!-- BEGIN OFFCANVAS SEARCH -->
            <div id="offcanvas-chat-list" class="offcanvas-pane width-8">
               <div class="offcanvas-head">
                  <header class="text-primary">Chat collaboratif</header>
                  <div class="offcanvas-tools">
                     <a class="btn btn-icon-toggle btn-default-light pull-right" data-dismiss="offcanvas">
                     <i class="md md-close"></i>
                     </a>
                  </div>
               </div>
               <div class="offcanvas-body no-padding">
                  <ul class="card-head nav nav-tabs tabs-accent" data-toggle="tabs">
                     <li class="active"><a href="#web1" onclick="loadSharedNotes('byUser')">Mes Partages</a></li>
                     <li><a href="#web1" onclick="loadSharedNotes('withUser')">Partagees avec moi</a></li>
                  </ul>
                  <ul class="list" id="sharedNotesList">
                     <li class="tile">
                        <a class="tile-content ink-reaction" href="#offcanvas-chat" onclick="loadChataData()" data-toggle="offcanvas" data-backdrop="false">
                           <div class="tile-icon">
                              <img src="../../assets/img/avatar4.jpg?1404026791" alt="" />
                           </div>
                           <div class="tile-text">
                              Alex Nelson
                              <small>Partage le 10/10/2016</small>
                           </div>

                        </a>
                        <a><i style="padding-bottom: 23px;padding-right: 6px;" class="md md-settings"></i></a>
                        <!-- <div class="tile-icon">
                           <img src="../../assets/img/avatar4.jpg?1404026791" alt="" />
                        </div> -->
                     </li>
                     <li class="tile">
                        <a class="tile-content ink-reaction" href="#offcanvas-chat" data-toggle="offcanvas" data-backdrop="false">
                           <div class="tile-icon">
                              <img src="../../assets/img/avatar4.jpg?1404026791" alt="" />
                           </div>
                           <div class="tile-text">
                              Alex Nelson
                              <small>123-123-3210</small>
                           </div>
                        </a>
                     </li>
                  </ul>
               </div>
               <!--end .offcanvas-body -->
            </div>
            <!--end .offcanvas-pane -->
         </div>
         <!--end .offcanvas-->
         <!-- END OFFCANVAS RIGHT -->
      </div>
      <!--end #base-->
      <!-- END BASE -->
      <div class="modal fade" id="delete-file-modal" role="dialog">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Confirmation</h4>
               </div>
               <form class="form-horizontal" method="post" id="delete_file_form">
                  <div class="modal-body">
                     Voulez-vous vraiment supprimer cette note ?
                  </div>
                  <div class="modal-footer">
                     <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insert" id="bt_delete">Supprimer</button>
                     <button data-dismiss="modal" class="btn btn-default" name="in_confirm_insert" id="bt_cancel">Annuler</button>
                  </div>
               </form>
            </div>
         </div>
      </div>
      <div class="modal fade" id="save-file-modal" role="dialog">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Confirmation</h4>
               </div>
               <form class="form-horizontal" method="post" id="delete_file_form">
                  <div class="modal-body">
                     Voulez vous enregistrer la note actuelle ?
                  </div>
                  <div class="modal-footer">
                     <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insert" id="bt_cancel">Non</button>
                     <button data-dismiss="modal" class="btn btn-primary" name="in_confirm_insert" id="bt_delete">Oui</button>
                  </div>
               </form>
            </div>
         </div>
      </div>
      <div class="modal fade" id="upload-modal" role="dialog">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Confirmation</h4>
               </div>
               <!--   <form action="/new" class="dropzone" id="my-awesome-dropzone">
                  <div class="dz-message">
                  	<h3>Drop files here or click to upload.</h3>
                  	<em>(This is just a demo dropzone. Selected files are <strong>not</strong> actually uploaded.)</em>
                  </div>
                  </form> -->
               <div style="cursor:pointer;height:50px;">
                  <div class="fileUpload btn btn-primary">
                     <span>Upload</span>
                     <input type="file" id="uploadInput" class="upload" accept="image/*"/>
                     <form id="uploadForm"
                        enctype="multipart/form-data"
                        action="/uploadProfilePicture"
                        method="post">
                        <input type="file" name="userPhoto" id="av" />
                        <input type="submit" value="Upload Image" name="submit">
                        <span id = "status"></span>
                     </form>
                  </div>
                  <!-- <input type="file" style="visibility:hidden;" /> -->
               </div>
               <div class="modal-footer">
                  <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insert" id="bt_cancel">Non</button>
                  <button data-dismiss="modal" class="btn btn-primary" name="in_confirm_insert" id="bt_delete">Oui</button>
               </div>
            </div>
         </div>
      </div>
      <div class="modal fade" id="refreshDataModal" role="dialog">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Mise a jour du des donnÃ©es</h4>
               </div>
               <form class="form-horizontal" method="post" id="error-form">
                  <div class="modal-body">
                  </div>
                  <div class="modal-footer">
                     <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insertion" id="bt_cancelerror">Fermer</button>
                  </div>
               </form>
            </div>
         </div>
      </div>
      <div class="modal fade" id="error-modal" role="dialog">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Choisir un dossier dans lequel enregistrer cette note</h4>
               </div>
               <form class="form-horizontal" method="post" id="error-form">
                  <div class="modal-body">
                     Une erreur s'est produite
                  </div>
                  <div class="modal-footer">
                     <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insertion" id="bt_cancelerror">Fermer</button>
                  </div>
               </form>
            </div>
         </div>
      </div>
      <div class="modal fade" id="error-save-modal" role="dialog">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Erreur</h4>
               </div>
               <form class="form-horizontal" method="post" id="error-form">
                  <div class="modal-body">
                     Une erreur inattendue s'est produite
                  </div>
                  <div class="modal-footer">
                     <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insertion" id="bt_cancelerror">Fermer</button>
                  </div>
               </form>
            </div>
         </div>
      </div>
      <div class="modal fade" id="chose-folder-modal" role="dialog">
         <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Choisir un dossier dans lequel enregistrer cette note</h4>
               </div>
               <div class="modal-body" id="mymodalForm">
                  <div class="radio radio-styled">
                     <label>
                     <input type="radio" name="optionsRadios" value="1" checked >
                     <span>Enregistrer dans un dossier existant</span>
                     </label>
                  </div>
                  <select class="form-control" id="sel1" >
                     <option>1</option>
                     <option>2</option>
                     <option>3</option>
                     <option>4</option>
                  </select>
                  <br>
                  <div class="radio radio-styled">
                     <label>
                     <input type="radio" name="optionsRadios" value="2"  >
                     <span>Creer un nouveau dossier</span>
                     </label>
                  </div>
                  <input type="text" placeholder="Nom du dossier" disabled class="form-control" id="foldername" >
               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
                  <button type="button" class="btn btn-primary" id="btSave" data-dismiss="modal" onclick="saveNewNote()">Enregistrer</button>
               </div>
            </div>
         </div>
      </div>
      <!-- BEGIN SIMPLE MODAL MARKUP -->
      <div class="modal fade" id="simpleModal" tabindex="-1" role="dialog" aria-labelledby="simpleModalLabel" aria-hidden="true">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 class="modal-title" id="simpleModalLabel">Gerer les dossiers</h4>
               </div>
               <div class="modal-body">
                  <div class="alert alert-danger" role="alert">
                     La suppression est <strong>definitive</strong> et supprimera par la meme occasion toutes les notes du dossier
                  </div>
                  <ul class="list" id="manageFolderList">
                     <li class="tile">
                        <a class="tile-content ink-reaction" href="#2">
                           <div class="tile-icon">
                              <i class="fa fa-folder"></i>
                           </div>
                           <div class="tile-text">Abbey Johnson</div>
                        </a>
                        <a class="btn btn-flat ink-reaction">
                        <i class="fa fa-trash"></i>
                        </a>
                     </li>
                     <li class="tile">
                        <a class="tile-content ink-reaction" href="#2">
                           <div class="tile-icon">
                              <i class="fa fa-folder"></i>
                           </div>
                           <div class="tile-text">Abbey Johnson</div>
                        </a>
                        <a class="btn btn-flat ink-reaction">
                        <i class="fa fa-trash"></i>
                        </a>
                     </li>
                  </ul>
               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
               </div>
            </div>
            <!-- /.modal-content -->
         </div>
         <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->
      <!-- END SIMPLE MODAL MARKUP -->
      <div class="modal fade" id="shareModal" tabindex="-1" role="dialog" aria-labelledby="shareModalLabel" aria-hidden="true">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 class="modal-title" id="simpleModalLabel">Partager une note</h4>
               </div>
               <div class="modal-body ">
                  <div class="alert alert-danger" role="alert" id="errorShareDiv" style="display:none;">
                     Addresse email incorrecte
                  </div>
                  <ul class="list">
                     <li class="tile">
                        <a class="tile-content ink-reaction" href="#2">
                           <div class="tile-icon">
                              <i class="fa fa-user"></i>
                           </div>
                           <div class="tile-text">
                              <input type="text" placeholder="Email du destinataire" class="form-control" id="sendTo">
                           </div>
                        </a>
                        <div class="btn-group" style="vertical-align:baseline !important;">
													<button type="button" id="sharingRight" class="btn ink-reaction btn-flat dropdown-toggle" data-toggle="dropdown" style="font-size: 11px !important;">
														Peut modifier et partager <i class="fa fa-caret-down text-default-light"></i>
													</button>
													<ul class="dropdown-menu animation-slide" role="menu">
														<li><a href="#" onclick="changeSharingRight(this)">Peut modifier sans partager</a></li>
														<li><a href="#" onclick="changeSharingRight(this)">Peut seulement afficher</a></li>
													</ul>
												</div>
                        <a class="btn btn-flat ink-reaction">
                        <i class="fa fa-user-plus" onclick="addDestinator()"></i>
                        </a>

                     </li>
                  </ul>
                  <div class="list-tags" style="margin-left:20px;">
                  </div>
               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
                  <button type="button" disabled class="btn btn-primary" id="btShare" data-dismiss="modal" onclick="shareToSelectedUser()">Partager</button>
               </div>
            </div>
            <!-- /.modal-content -->
         </div>
         <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->

      <div class="modal fade" id="manageRightModal" tabindex="-1" role="dialog" aria-labelledby="simpleModalLabel" aria-hidden="true">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 class="modal-title" id="simpleModalLabel">Gerer les dossiers</h4>
               </div>
               <div class="modal-body table-responsive">
                   <table class="table table-hover">
                     <thead>
                       <tr>
                         <th>Avatar</th>
                         <th>Email</th>
                         <th>Droits</th>
                         <th class="text-right"></th>
                       </tr>
                     </thead>
                     <tbody id="noteSharingSettings">
                       <tr>
                         <td><img class="img-circle width-1" src="../../assets/img/avatar2.jpg?1404026449" alt="" /></td>
                         <td>absssssssssssc@xyz.com</td>
                         <!-- <td>Fuisset delicatissimi duo, qui ut animal noluisse erroribus.</td> -->
                         <td>	<label class="radio-inline radio-styled">
                             <input type="radio" name="inlineRadioOptions" value="option1"><span>Peut modifier et partager</span>
                           </label>
                           <label class="radio-inline radio-styled">
                             <input type="radio" name="inlineRadioOptions" value="option2"><span>Peut modifier sans partager</span>
                           </label>
                           <label class="radio-inline radio-styled">
                             <input type="radio" name="inlineRadioOptions" value="option3"><span>Peut seulement afficher</span>
                           </label></td>
                         <td class="text-right">
                           <button type="button" class="btn btn-icon-toggle" data-toggle="tooltip" data-placement="top" data-original-title="Delete row"><i class="fa fa-trash-o"></i></button>
                         </td>
                       </tr>
                       <tr>
                         <td><img class="img-circle width-1" src="../../assets/img/avatar4.jpg?1404026791" alt="" /></td>
                         <td>abc@xyz.com</td>
                         <td>Ea eum veniam audire. Dicant vituperata consequuntur.</td>
                         <td class="text-right">
                           <button type="button" class="btn btn-icon-toggle" data-toggle="tooltip" data-placement="top" data-original-title="Delete row"><i class="fa fa-trash-o"></i></button>
                         </td>
                       </tr>
                       <tr>
                         <td><img class="img-circle width-1" src="../../assets/img/avatar11.jpg?1404026774" alt="" /></td>
                         <td>abc@xyz.com</td>
                         <td>Per at postea mediocritatem, vim numquam aliquid eu, in nam sale gubergren.</td>
                         <td class="text-right">
                           <button type="button" class="btn btn-icon-toggle" data-toggle="tooltip" data-placement="top" data-original-title="Delete row"><i class="fa fa-trash-o"></i></button>
                         </td>
                       </tr>
                     </tbody>
                   </table>


               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
               </div>
            </div>
            <!-- /.modal-content -->
         </div>
         <!-- /.modal-dialog -->
      </div>
      <!-- END SIMPLE MODAL MARKUP -->
      <!-- BEGIN JAVASCRIPT -->
      <script src="../../assets/js/libs/jquery/jquery-1.11.2.min.js"></script>
      <script src="../../assets/js/libs/jquery/jquery-migrate-1.2.1.min.js"></script>
      <script src="../../assets/js/libs/bootstrap/bootstrap.min.js"></script>
      <script src="../../assets/js/libs/spin.js/spin.min.js"></script>
      <script src="../../assets/js/libs/autosize/jquery.autosize.min.js"></script>
      <script src="../../assets/js/libs/nanoscroller/jquery.nanoscroller.min.js"></script>
      <script src="../../assets/js/libs/ckeditor/ckeditor.js"></script>
      <script src="../../assets/js/libs/ckeditor/adapters/jquery.js"></script>
      <script src="../../assets/js/libs/summernote/summernote.min.js"></script>
      <script src="../../assets/js/libs/socket-io/socket.js"></script>
      <script src="../../assets/js/core/source/App.js"></script>
      <script src="../../assets/js/core/source/AppNavigation.js"></script>
      <script src="../../assets/js/core/source/AppOffcanvas.js"></script>
      <script src="../../assets/js/core/source/AppCard.js"></script>
      <script src="../../assets/js/core/source/AppForm.js"></script>
      <script src="../../assets/js/core/source/AppNavSearch.js"></script>
      <script src="../../assets/js/core/source/AppVendor.js"></script>
      <script src="../../assets/js/core/demo/Demo.js"></script>
      <script src="../../assets/js/core/demo/DemoFormEditors.js"></script>
      <script src="../../assets/js/libs/dropzone/dropzone.min.js"></script>
      <script type="text/javascript" src="main.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
      <script type="text/javascript">
         var timeOutFunction; // used to reset timer in the timeout function used for ajax request

         $('#mymodalForm input').on('change', function() {
         //alert($('input[name="optionsRadios"]:checked', '#mymodalForm').val());
         if($('input[name="optionsRadios"]:checked', '#mymodalForm').val() ==1)
         {
         	$('#foldername').prop("disabled", true);
         	$('#sel1').prop("disabled", false);
         	//$('#btSave').prop("disabled", false);
         }
         else{
         	$('#foldername').prop("disabled", false);
         	$('#sel1').prop("disabled", true);
         	//$('#btSave').prop("disabled", true);


         }
         });



         $(document).ready(function() {
         //var socket = io();
         //console.log(socket);
          $('#offcanvas-chat .nano.has-scrollbar').bind('scroll', function()
                              {
                                 console.log("inside scroll function");
                                if($(this).scrollTop() + $(this).innerHeight()>=$(this)[0].scrollHeight)
                                {
                                  alert('end reached');
                                }
                              });


         $( "#chatMessage" ).keypress(function( e ) {
         	addChatMessageSender(e);
         });

         $('#refreshDataModal ').on('hidden.bs.modal', function () {
            location.reload();
          });

         joinRoom(); // add user to the differents rooms to which he belongs to
         loadSharedNotes('byUser') //load shared notes' data

         $("#searchbtn").on('click', function() {
           		search();
         });

         $("#userFolder").on('click', function() {
         	getFolderManageModal();
         	$("#simpleModal").modal('show');

         });

         $("#chatMessageIcon").on('click', function() {
         	$(".md-chat .badge").remove();

         });
         $("#uploadlink").on('click', function() {
           		$("#uploadInput").click();
         });

         $("#uploadInput").change(function() {
         		uploadProfilePicture(this);

         });


            $(".gui-folder").find('li.active:first').children().trigger("click");

            $("#sendTo").keydown(function(){
            	if($("#errorShareDiv").is(":visible"))
                	$("#errorShareDiv").hide();
            });

         });

         $('#dSummernote').summernote({
            height: 420,
            placeholder: 'write here...',
            //onChange: formatting,
            //onkeyup : save
            //onKeypress : save
         });

        $(".note-editable").bind("DOMNodeInserted", function(e) {
            formattedContentSave($(".note-editable").html());
        });

        $(".note-editable").keypress(function( e ) {
          save(e);
        }).on('keydown', function(e) {
          switch (e.key) {
            case "Backspace":
              var selection = document.getSelection();
              var cursorPos = selection.anchorOffset;
              var oldContent = selection.anchorNode.nodeValue;
              var newContent = oldContent.substring(0, cursorPos-1) + oldContent.substring(cursorPos);
              specialCharacterSave("Backspace",cursorPos);
              break;
            case "Delete":
              var selection = document.getSelection();
              var cursorPos = selection.anchorOffset;
              var oldContent = selection.anchorNode.nodeValue;
              var newContent = oldContent.substring(0, cursorPos) + oldContent.substring(cursorPos+1);
              // console.log("Delete key has been hit at position "+cursorPos);
              // console.log("newContent",newContent);
              specialCharacterSave("Delete",cursorPos);
              break;
            default:
            //console.log("key",e.key);

          }

 });


     function formatting(e,f){
       console.log("e",e);
       console.log("f",f);
       console.log("content",$(".note-editable").html());
       console.log("inside formatting");
     }
      </script>
      <!-- END JAVASCRIPT -->
   </body>
</html>
