<!DOCTYPE html>
<html lang="en">
	<head>
		<title>NoteApp</title>

		<!-- BEGIN META -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="keywords" content="your,keywords">
		<meta name="description" content="Short explanation about this website">
		<!-- END META -->

		<!-- BEGIN STYLESHEETS -->
		<link href='http://fonts.googleapis.com/css?family=Roboto:300italic,400italic,300,400,500,700,900' rel='stylesheet' type='text/css'/>
		<link type="text/css" rel="stylesheet" href="/assets/css/theme-default/bootstrap.css?1422792965" />
		<link type="text/css" rel="stylesheet" href="/assets/css/theme-default/materialadmin.css?1425466319" />
		<link type="text/css" rel="stylesheet" href="/assets/css/theme-default/font-awesome.min.css?1422529194" />
		<link type="text/css" rel="stylesheet" href="/assets/css/theme-default/material-design-iconic-font.min.css?1421434286" />
		<link type="text/css" rel="stylesheet" href="/assets/css/theme-default/libs/summernote/summernote.css?1425218701" />
		<link type="text/css" rel="stylesheet" href="/assets/css/theme-default/libs/dropzone/dropzone-theme.css?1424887864" />
		<link rel="shortcut icon" href="assets/ico/favicon.png">


		     
		     <style type="text/css">
		     .fileUpload {
    position: relative;
    overflow: hidden;
    margin: 10px;
}
.fileUpload input.upload {
    position: absolute;
    top: 0;
    right: 0;
    margin: 0;
    padding: 0;
    font-size: 20px;
    cursor: pointer;
    opacity: 0;
    filter: alpha(opacity=0);
}
		     </style>
		     


		<!-- END STYLESHEETS -->

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script type="text/javascript" src="../../assets/js/libs/utils/html5shiv.js?1403934957"></script>
		<script type="text/javascript" src="../../assets/js/libs/utils/respond.min.js?1403934956"></script>
		<![endif]-->
	</head>
	<body class="menubar-hoverable header-fixed menubar-first full-content ">

		<!-- BEGIN HEADER-->
		<header id="header" >
			<div class="headerbar">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="headerbar-left">
					<ul class="header-nav header-nav-options">
						<li class="header-nav-brand" >
							<div class="brand-holder">
								<a href="../../html/dashboards/dashboard.html">
									<span class="text-lg text-bold text-primary">NOTEAPP</span>
								</a>
							</div>
						</li>
						<li>
							<a class="btn btn-icon-toggle menubar-toggle" data-toggle="menubar" href="javascript:void(0);">
								<i class="fa fa-bars"></i>
							</a>
						</li>
					</ul>
				</div>
				<div class="headerbar-right">

					<ul class="header-nav header-nav-profile">
						<li class="dropdown">
							<a href="javascript:void(0);" class="dropdown-toggle ink-reaction" data-toggle="dropdown">
								<img id="avatar" src="<%= avatar %>" alt="" />
								<span class="profile-info" account="<%= account_type %>">
									<%= email %>
								</span>
							</a>
							<ul class="dropdown-menu animation-dock">
								<% if(account_type == 'local'){ %>
								<li><a href="#"  id="uploadlink"><i class="fa fa-fw fa-user"></i> Changer sa photo de profil</a></li>
								<% } %>
								<li><a href="#" id="userFolder"><i class="fa fa-fw fa-folder"></i> Gerer les dossiers</a></li>
								<li class="divider"></li>
								
								<li><a href="/logout"><i class="fa fa-fw fa-power-off text-danger"></i> Logout </a></li>
							</ul><!--end .dropdown-menu -->
						</li><!--end .dropdown -->
					</ul><!--end .header-nav-profile -->
					<ul class="header-nav header-nav-toggle">
						<li>
							<a class="btn btn-icon-toggle btn-default" href="#offcanvas-search" data-toggle="offcanvas" data-backdrop="false">
								<i class="fa fa-search"></i>
							</a>
						</li>
						<li>
							<a class="btn btn-icon-toggle btn-default" href="#offcanvas-chat" data-toggle="offcanvas" data-backdrop="false">
								<i class="md md-chat"></i>
							</a>
						</li>
					</ul><!--end .header-nav-toggle -->
				</div><!--end #header-navbar-collapse -->
			</div>
		</header>
		<!-- END HEADER-->

		<!-- BEGIN BASE-->
		<div id="base">

			<!-- BEGIN OFFCANVAS LEFT -->
			<div class="offcanvas">
			</div><!--end .offcanvas-->
			<!-- END OFFCANVAS LEFT -->

			<!-- BEGIN CONTENT-->
			<div id="content">
				<section class="style-default-bright">

					<!-- BEGIN INBOX -->
					<div class="section-body">
						<div class="row">
							<div class="col-lg-12"> 
										<div class="input-group-content">
												<input type="text" class="form-control" id="noteTitle" placeholder="Entrer le type de la note">

												
											</div>

										<!-- <h1 id="noteTitle" class="no-margin">Reaching the top</h1> -->
										<!-- <select class="form-control" id="sel1" >
			            <option>1</option>
			            <option>2</option>
			            <option>3</option>
			            <option>4</option>
		          	</select> -->

										<div class="btn-group stick-top-right">
											<!-- <select class="btn ink-reaction btn-flat btn-primary " id="sel1" >
									            <option>Option 1</option>
									            <option>2</option>
									            <option>3</option>
									            <option>4</option>
								          	</select> -->
								          	<button type="button" id="currentFolder" selectedFolderId="<%= data[0].id %>" class="btn ink-reaction btn-flat dropdown-toggle" data-toggle="dropdown">
														<%= data[0].name %> <i class="fa fa-caret-down text-default-light" style='margin-left: 7px;'></i>
													</button>
													<ul class="dropdown-menu animation-zoom" id="folderList" role="menu">
														<% for(var i=0; i<data.length; i++) { %>
														<li><a href="#" folderid="<%= data[i].id %>" onclick="changeNoteFolder(this)"><%= data[i].name %></a></li>
														<% } %>
													</ul>
										
											<a class="btn btn-icon-toggle btn-default" onclick="getFolderManageModal()" data-toggle="modal" data-target="#simpleModal"><i class="fa fa-folder" ></i></a>
											
											<a class="btn btn-icon-toggle btn-default" onclick="addNewNote()"><i class="md md-add"></i></a>
											<a id="toastTest" class="btn btn-icon-toggle btn-default" onclick="deleteNote()"><i class="md md-delete"></i></a>
											<a onclick="updateNote()"  class="btn btn-icon-toggle btn-default"><i class="md md-save"></i></a>
										</div>
										<span class="pull-right text-default-light" id="saveMessage"></span>
										<hr/>

								
								<form class="form" id="formCompose">
									
									<div class="form-group">
										<!-- <div id="simple-summernote" name="message" class="form-control control-12-rows" spellcheck="false"></div> -->

										<div id="dSummernote"></div>
									</div><!--end .form-group -->
								</form>
							</div><!--end .col -->
							<!-- END MAIL COMPOSE -->

						</div><!--end .row -->
					</div><!--end .section-body -->
					<!-- END INBOX -->


				</section>
			</div><!--end #content-->
			<!-- END CONTENT -->

			<!-- BEGIN MENUBAR-->
			<div id="menubar" class="menubar-inverse ">
				<div class="menubar-fixed-panel">
					<div>
						<a class="btn btn-icon-toggle btn-default menubar-toggle" data-toggle="menubar" href="javascript:void(0);">
							<i class="fa fa-bars"></i>
						</a>
					</div>
					<div class="expanded">
						<a href="../../html/dashboards/dashboard.html">
							<span class="text-lg text-bold text-primary ">NOTEAPP</span>
						</a>
					</div>
				</div>
				<div class="menubar-scroll-panel">

					<!-- BEGIN MAIN MENU -->
					<ul id="main-menu" class="gui-controls">

            <% for(var i=0; i<data.length; i++) { %>
						<li class="gui-folder">
							<a>
								<div class="gui-icon"><i class="md md-folder"></i></div>
								<span class="title" fid="<%= data[i].id %>"><%= data[i].name %></span>
							</a>
							<ul>
								<% for(var j=0; j<data[i]["notes"].length; j++) { %>
								<% if(i==0 && j==0){ %>
									   <li><a href="#" id="<%= data[i]["notes"][j].id %>" class="active" onclick="loadNote(this)"><span class="title"><%= data[i]["notes"][j].title %><i style="float: right;" class="md md-delete" onclick="deleteNote(this)"></i></span></a></li>
									 <% } else{ %>  
									   <li><a href="#" id="<%= data[i]["notes"][j].id %>" onclick="loadNote(this)"><span class="title"><%= data[i]["notes"][j].title %><i style="float: right;" class="md md-delete" onclick="deleteNote(this,'menu')"></i></span></a></li>
								<% } %>

								<% } %>
							</ul>
						</li>
            

            <% } %>

					</ul><!--end .main-menu -->
					<!-- END MAIN MENU -->

					
				</div><!--end .menubar-scroll-panel-->
			</div><!--end #menubar-->
			<!-- END MENUBAR -->

			<!-- BEGIN OFFCANVAS RIGHT -->
			<div class="offcanvas">

				<!-- BEGIN OFFCANVAS SEARCH -->
				<div id="offcanvas-search" class="offcanvas-pane width-8">
					<div class="offcanvas-head">
						<header class="text-primary">Rechercher dans vos notes</header>
					
						<div class="offcanvas-tools">
							<a class="btn btn-icon-toggle btn-default-light pull-right" data-dismiss="offcanvas">
								<i class="md md-close"></i>
							</a>
						</div>
					</div>
					<div class="offcanvas-body no-padding">
						<ul class="list" id="searchResult">
							<li class="tile divider-full-bleed">
								<div class="tile-content">
									<div class="tile-text">	
										<div class="input-group-content">
												<form class="form">
													<div class="form-group">
														<div class="input-group input-group-md">
															<div class="input-group-content">
																<input type="text" class="form-control" id="searchInput" placeholder="Recherche">
																<div class="form-control-line"></div>
															</div>
															<div class="input-group-btn">
																<!-- <button class="btn btn-floating-action btn-default-bright" type="button"><i class="fa fa-search"></i></button> -->
																<!-- <button onclick="search()" class="btn btn-icon-toggle ink-reaction"><i class="fa fa-search"></i></button> -->
																<a id="searchbtn" class="btn btn-icon-toggle btn-default" ><i class="fa fa-search"></i></a>

															</div>
														</div>
													</div><!--end .form-group -->
												</form>
											</div>
									</div>
								</div>
							</li>

							


						</ul>
					</div><!--end .offcanvas-body -->
				</div><!--end .offcanvas-pane -->
				<!-- END OFFCANVAS SEARCH -->

				<div id="offcanvas-chat" class="offcanvas-pane style-default-light width-12">
					<div class="offcanvas-head style-default-bright">
						<header class="text-primary">Chat with Ann Laurens</header>
						<div class="offcanvas-tools">
							<a class="btn btn-icon-toggle btn-default-light pull-right" data-dismiss="offcanvas">
								<i class="md md-close"></i>
							</a>
							<a class="btn btn-icon-toggle btn-default-light pull-right" href="#offcanvas-search" data-toggle="offcanvas" data-backdrop="false">
								<i class="md md-arrow-back"></i>
							</a>
						</div>
						<form class="form">
							<div class="form-group floating-label">
								<textarea name="chatMessage" id="chatMessage" class="form-control autosize" rows="1"></textarea>
								<label for="chatMessage">Leave a message</label>
							</div>
						</form>
					</div>
					<div class="offcanvas-body">
						<ul class="list-chats">
							<li>
								<div class="chat">
									<div class="chat-avatar"><img class="img-circle" src="../../assets/img/avatar1.jpg?1403934956" alt="" /></div>
									<div class="chat-body">
										Yes, it is indeed very beautiful.
										<small>10:03 pm</small>
									</div>
								</div><!--end .chat -->
							</li>
							<li class="chat-left">
								<div class="chat">
									<div class="chat-avatar"><img class="img-circle" src="../../assets/img/avatar9.jpg?1404026744" alt="" /></div>
									<div class="chat-body">
										Did you see the changes?
										<small>10:02 pm</small>
									</div>
								</div><!--end .chat -->
							</li>
							
						</ul>
					</div><!--end .offcanvas-body -->
				</div><!--end .offcanvas-pane -->


			</div><!--end .offcanvas-->
			<!-- END OFFCANVAS RIGHT -->



		</div><!--end #base-->
		<!-- END BASE -->

		<div class="modal fade" id="delete-file-modal" role="dialog">
		    <div class="modal-dialog">
		        <div class="modal-content">
		        	<div class="modal-header">
			          <button type="button" class="close" data-dismiss="modal">&times;</button>
			          <h4 class="modal-title">Confirmation</h4>
			        </div>

		            <form class="form-horizontal" method="post" id="delete_file_form">


		                <div class="modal-body">

		                    Voulez-vous vraiment supprimer cette note ? 

		                </div>  

		                <div class="modal-footer">

		                    <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insert" id="bt_delete">Supprimer</button>
		                    <button data-dismiss="modal" class="btn btn-default" name="in_confirm_insert" id="bt_cancel">Annuler</button>

		                </div>

		            </form>

		        </div>
		    </div>
		</div>

		<div class="modal fade" id="save-file-modal" role="dialog">
		    <div class="modal-dialog">
		        <div class="modal-content">
		        	<div class="modal-header">
			          <button type="button" class="close" data-dismiss="modal">&times;</button>
			          <h4 class="modal-title">Confirmation</h4>
			        </div>

		            <form class="form-horizontal" method="post" id="delete_file_form">


		                <div class="modal-body">

		                    Voulez vous enregistrer la note actuelle ?  

		                </div>  

		                <div class="modal-footer">

		                    
		                    <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insert" id="bt_cancel">Non</button>
		                    <button data-dismiss="modal" class="btn btn-primary" name="in_confirm_insert" id="bt_delete">Oui</button>

		                </div>

		            </form>

		        </div>
		    </div>
		</div>

		<div class="modal fade" id="upload-modal" role="dialog">
		    <div class="modal-dialog">
		        <div class="modal-content">
		        	<div class="modal-header">
			          <button type="button" class="close" data-dismiss="modal">&times;</button>
			          <h4 class="modal-title">Confirmation</h4>
			        </div>

			      <!--   <form action="/new" class="dropzone" id="my-awesome-dropzone">
						<div class="dz-message">
							<h3>Drop files here or click to upload.</h3>
							<em>(This is just a demo dropzone. Selected files are <strong>not</strong> actually uploaded.)</em>
						</div>
					</form> -->
					<div style="cursor:pointer;height:50px;">
						<div class="fileUpload btn btn-primary">
						    <span>Upload</span>
						    <input type="file" id="uploadInput" class="upload" accept="image/*"/>
						     <form id="uploadForm"
						          enctype="multipart/form-data"
						          action="/uploadProfilePicture"
						          method="post">
						      <input type="file" name="userPhoto" id="av" />
						      <input type="submit" value="Upload Image" name="submit">
						      <span id = "status"></span>
						    </form>
						</div>
						<!-- <input type="file" style="visibility:hidden;" /> -->

					</div>

					 <div class="modal-footer">

		                    
		                    <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insert" id="bt_cancel">Non</button>
		                    <button data-dismiss="modal" class="btn btn-primary" name="in_confirm_insert" id="bt_delete">Oui</button>

		                </div>


		        </div>
		    </div>
		</div>




		<div class="modal fade" id="error-modal" role="dialog">
		    <div class="modal-dialog">
		        <div class="modal-content">
		        	<div class="modal-header">
			          <button type="button" class="close" data-dismiss="modal">&times;</button>
			          <h4 class="modal-title">Choisir un dossier dans lequel enregistrer cette note</h4>
			        </div>

		            <form class="form-horizontal" method="post" id="error-form">


		                <div class="modal-body">

		                    Une erreur s'est produite
		                </div>  

		                <div class="modal-footer">

		                    <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insertion" id="bt_cancelerror">Fermer</button>

		                </div>

		            </form>

		        </div>
		    </div>
		</div>


		<div class="modal fade" id="error-save-modal" role="dialog">
		    <div class="modal-dialog">
		        <div class="modal-content">
		        	<div class="modal-header">
			          <button type="button" class="close" data-dismiss="modal">&times;</button>
			          <h4 class="modal-title">Erreur</h4>
			        </div>

		            <form class="form-horizontal" method="post" id="error-form">


		                <div class="modal-body">

		                    Une erreur inattendue s'est produite
		                </div>  

		                <div class="modal-footer">

		                    <button data-dismiss="modal" class="btn btn-danger" name="in_confirm_insertion" id="bt_cancelerror">Fermer</button>

		                </div>

		            </form>

		        </div>
		    </div>
		</div>



	  	<div class="modal fade" id="chose-folder-modal" role="dialog">
		    <div class="modal-dialog">
		    
		      <!-- Modal content-->
		      <div class="modal-content">
		        <div class="modal-header">
		          <button type="button" class="close" data-dismiss="modal">&times;</button>
		          <h4 class="modal-title">Choisir un dossier dans lequel enregistrer cette note</h4>
		        </div>
		        <div class="modal-body" id="mymodalForm">
		          	

					<div class="radio radio-styled">
						<label>
							<input type="radio" name="optionsRadios" value="1" checked >
							<span>Enregistrer dans un dossier existant</span>
						</label>
					</div>
				 	<select class="form-control" id="sel1" >
			            <option>1</option>
			            <option>2</option>
			            <option>3</option>
			            <option>4</option>
		          	</select><br>

		          	<div class="radio radio-styled">
						<label>
							<input type="radio" name="optionsRadios" value="2"  >
							<span>Creer un nouveau dossier</span>
						</label>
					</div>
					<input type="text" placeholder="Nom du dossier" disabled class="form-control" id="foldername" >
		        </div>
		        <div class="modal-footer">
		          <button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
		          <button type="button" class="btn btn-primary" id="btSave" data-dismiss="modal" onclick="saveNewNote()">Enregistrer</button>
		        </div>
		      </div>
		      
		    </div>
	  	</div>


		  <!-- BEGIN SIMPLE MODAL MARKUP -->
		<div class="modal fade" id="simpleModal" tabindex="-1" role="dialog" aria-labelledby="simpleModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
						<h4 class="modal-title" id="simpleModalLabel">Gerer les dossiers</h4>
					</div>
					<div class="modal-body">
						<div class="alert alert-danger" role="alert">
							La suprression est <strong>definitive</strong> et supprimera par la meme occasion toutes les notes du dossier
						</div>
						<ul class="list" id="manageFolderList">
							<li class="tile">
								<a class="tile-content ink-reaction" href="#2">
									<div class="tile-icon">
										<i class="fa fa-folder"></i>
									</div>
									<div class="tile-text">Abbey Johnson</div>
								</a>
								<a class="btn btn-flat ink-reaction">
									<i class="fa fa-trash"></i>
								</a>
							</li>
							<li class="tile">
								<a class="tile-content ink-reaction" href="#2">
									<div class="tile-icon">
										<i class="fa fa-folder"></i>
									</div>
									<div class="tile-text">Abbey Johnson</div>
								</a>
								<a class="btn btn-flat ink-reaction">
									<i class="fa fa-trash"></i>
								</a>
							</li>
						</ul>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal-dialog -->
		</div><!-- /.modal -->
		<!-- END SIMPLE MODAL MARKUP -->



		
		<!-- END SIMPLE MODAL MARKUP -->

		<!-- BEGIN JAVASCRIPT -->
		<script src="../../assets/js/libs/jquery/jquery-1.11.2.min.js"></script>
		<script src="../../assets/js/libs/jquery/jquery-migrate-1.2.1.min.js"></script>
		<script src="../../assets/js/libs/bootstrap/bootstrap.min.js"></script>
		<script src="../../assets/js/libs/spin.js/spin.min.js"></script>
		<script src="../../assets/js/libs/autosize/jquery.autosize.min.js"></script>
		<script src="../../assets/js/libs/nanoscroller/jquery.nanoscroller.min.js"></script>
		<script src="../../assets/js/libs/ckeditor/ckeditor.js"></script>
		<script src="../../assets/js/libs/ckeditor/adapters/jquery.js"></script>
		<script src="../../assets/js/libs/summernote/summernote.min.js"></script>
		<script src="../../assets/js/libs/socket-io/socket.js"></script>
		<script src="../../assets/js/core/source/App.js"></script>
		<script src="../../assets/js/core/source/AppNavigation.js"></script>
		<script src="../../assets/js/core/source/AppOffcanvas.js"></script>
		<script src="../../assets/js/core/source/AppCard.js"></script>
		<script src="../../assets/js/core/source/AppForm.js"></script>
		<script src="../../assets/js/core/source/AppNavSearch.js"></script>
		<script src="../../assets/js/core/source/AppVendor.js"></script>
		<script src="../../assets/js/core/demo/Demo.js"></script>
		<script src="../../assets/js/core/demo/DemoFormEditors.js"></script>
		<script src="../../assets/js/libs/dropzone/dropzone.min.js"></script>
		<script type="text/javascript" src="main.js"></script> 
	  	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
	  	

	   <script type="text/javascript">
	   var timeOutFunction; // used to reset timer in the timeout function used for ajax request

			$('#mymodalForm input').on('change', function() {
				//alert($('input[name="optionsRadios"]:checked', '#mymodalForm').val()); 
				if($('input[name="optionsRadios"]:checked', '#mymodalForm').val() ==1) 
				{
					$('#foldername').prop("disabled", true);
					$('#sel1').prop("disabled", false);
					//$('#btSave').prop("disabled", false);
				}
				else{
					$('#foldername').prop("disabled", false);
					$('#sel1').prop("disabled", true);
					//$('#btSave').prop("disabled", true);


				}
			});
		    


			$(document).ready(function() {
				//var socket = io();
				//console.log(socket);

				$( "#chatMessage" ).keypress(function( e ) {
					addChatMessageSender(e);
				});

				$("#searchbtn").on('click', function() {
			   		search();
				});

				$("#userFolder").on('click', function() {
					getFolderManageModal();
					$("#simpleModal").modal('show');
			   		
				});
				$("#uploadlink").on('click', function() {
			   		$("#uploadInput").click();
				});

				$("#uploadInput").change(function() {
			 		uploadProfilePicture(this);

				});


			    $(".gui-folder").find('li.active:first').children().trigger("click");

			});

			$('#dSummernote').summernote({
			    height: 420,
			    placeholder: 'write here...',
			    onChange: test
			});


			function test()
			{
				clearTimeout(timeOutFunction);
				var attr = $("#noteTitle").attr("noteid");
				if(typeof attr !== typeof undefined && attr !== false){
					timeOutFunction =setTimeout(function () {
					$("#saveMessage").empty();
					$("#saveMessage").text("Enregistrement en cours ...");
					//console.log($('#dSummernote').code());
					autoSave();
				}, 1000);
				}
				
			    
			}



     	</script> 

		<!-- END JAVASCRIPT -->

	</body>
</html>
